"use strict";window.VariationVariableEditor=function(c,f){var s=null,l=null,t=null;function n(){this.showIdentifierFields=c.prop(!1)}function a(e){var t,n,a;t=document.getElementById("product-variable-wrap"),0<document.getElementsByClassName("variable-sort-handle").length&&Sortable.create(t,{group:"variable-sort",handle:".variable-sort-handle",onEnd:function(e){l.reindex(e.oldIndex,e.newIndex),v()}}),a=document.getElementsByClassName("product-variable-values"),n=0,[].forEach.call(a,function(e){Sortable.create(e,{group:"value-sort-"+n,handle:".value-sort-handle",onEnd:function(e){for(var t=e.item.getAttribute("data-id"),n=e.newIndex,a=null,r=0;r<l.length;r++){a=l[r];for(var i=0;i<a.values.length;i++)a.values[i].pk==t&&l[r].values.reindex(i,n)}v()}}),n+=1})}function v(){document.getElementById("id_variables-data").value=JSON.stringify(l)}function o(){return"$"+Math.random()}function d(i,l,o){var d=3<arguments.length&&void 0!==arguments[3]?arguments[3]:"$",e=!(4<arguments.length&&void 0!==arguments[4])||arguments[4],t=c.withAttr("value",function(e){l.identifier=e,v()}),u=function(e,t){l[o][e]=t,v()};return[f.map(s,function(e){var t=e.name,n=e.code,a=c.withAttr("value",f.partial(u,n)),r=d.replace("$",t);return c(i,[r&&r.length?c("label",r):null,c("input.form-control",{value:l[o][n]||"",placeholder:r,oninput:a,onchange:a})])}),e?c(i,[c("input.form-control",{value:l.identifier,placeholder:gettext("Identifier"),oninput:t,onchange:t})]):null]}function u(e){return c("i.fa.fa-bars."+e+".pull-left","")}function h(e,t,n){var a=e.showIdentifierFields(),r=interpolate(gettext("Value %s Name"),[n+1]);return c("tr",{"data-id":t.pk},c("th",[u("value-sort-handle"),r]),d("td",t,"texts","",a),c("td",c("a.btn.text-danger.btn-xs",{href:"#",onclick:function(){return t.DELETE=!0,v(),!1}},c("i.fa.fa-times-circle")," "+gettext("Delete value"))))}function r(e,t){var n=e.showIdentifierFields(),a=c("a.btn.btn-xs.text-danger",{href:"#",onclick:function(){if(0===t.values.length||confirm(gettext("Are you sure?")))return t.DELETE=!0,v(),!1}},c("i.fa.fa-times-circle")," "+gettext("Delete Variable")),r=c("a.btn.btn-xs.btn-text",{href:"#",onclick:function(e){t.values.push({pk:o(),identifier:"",texts:{}}),e.preventDefault()}},c("i.fa.fa-plus")," "+gettext("Add new value")),i=c("tr",[c("th",gettext("Variable Name"))].concat(d("td",t,"names","",n)).concat([c("td")])),l=f.map(f.reject(t.values,"DELETE"),f.partial(h,e));return c("div.product-variable",{key:t.pk},[c("div.variable-heading.clearfix",[u("variable-sort-handle"),c("h3.pull-left",gettext("Variable")),c("div.pull-right",a)]),c("div.variable-body",[c("div.table-responsive",[c("table.table.table-bordered",[c("thead",[c("tr",[c("th")].concat(f.map(s,function(e){var t=e.name;return c("th",t)})).concat([n?c("th",[gettext("Identifer")]):null,c("th")]))]),c("tbody.product-variable-name",i),c("tbody.product-variable-values",l)])]),c("div.new-row",r)])])}function i(e){var t=c("div.product-variable-wrap",{id:"product-variable-wrap"},f.map(f.reject(l,"DELETE"),f.partial(r,e))),n=c("p",[c("label.small",[c("input",{type:"checkbox",checked:!!e.showIdentifierFields(),onclick:c.withAttr("checked",e.showIdentifierFields)})," "+gettext("Show identifier fields (for advanced users)")])]);return l.length||(t=c("p.text-info",[c("i.fa.fa-exclamation-circle")," "+gettext("There are no variables defined."),c("hr")]),n=null),c("div",{config:a},[n,c("hr"),t,c("a.btn.btn-lg.btn-text",{href:"#",onclick:function(e){l.push({pk:o(),identifier:"",names:{},values:[]}),e.preventDefault()}},c("i.fa.fa-plus")," "+gettext("Add new variable"))])}return Array.prototype.reindex||(Array.prototype.reindex=function(e,t){this.splice(t,0,this.splice(e,1)[0])}),{init:function(e){t||(s=e.languages,l=e.variables,window.VariationVariableEditor.ctrl=t=c.mount(document.getElementById("variation-variable-editor"),{controller:n,view:i}))}}}(window.m,window._);
//# sourceMappingURL=product-variation-variable-editor.js.map
