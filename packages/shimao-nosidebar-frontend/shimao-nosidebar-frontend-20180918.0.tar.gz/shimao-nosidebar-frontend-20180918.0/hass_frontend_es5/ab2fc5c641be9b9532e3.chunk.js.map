{"version":3,"sources":["webpack:///./src/components/entity/ha-entity-picker.js","webpack:///./src/util/app-localstorage-document.js","webpack:///./node_modules/@polymer/app-storage/app-storage-behavior.js","webpack:///./src/components/ha-combo-box.js","webpack:///./src/components/ha-service-picker.js","webpack:///./src/panels/dev-service/ha-panel-dev-service.js"],"names":["HaEntityPicker","Object","_mixins_events_mixin_js__WEBPACK_IMPORTED_MODULE_10__","_mixins_localize_mixin_js__WEBPACK_IMPORTED_MODULE_9__","_polymer_polymer_polymer_element_js__WEBPACK_IMPORTED_MODULE_5__","_createClass","key","value","label","localize","hass","domainFilter","entityFilter","entityIds","keys","states","filter","eid","substr","indexOf","entities","sort","map","state","_common_entity_compute_state_name_js__WEBPACK_IMPORTED_MODULE_8__","a","newVal","this","_hass","opened","ev","stopPropagation","fire","get","_polymer_polymer_lib_utils_html_tag_js__WEBPACK_IMPORTED_MODULE_4__","_templateObject","allowCustomEntity","type","Boolean","observer","_states","Array","computed","autofocus","String","notify","Function","disabled","customElements","define","_polymer_app_storage_app_storage_behavior_js__WEBPACK_IMPORTED_MODULE_0__","__webpack_require__","_polymer_polymer_lib_legacy_polymer_fn_js__WEBPACK_IMPORTED_MODULE_1__","is","behaviors","properties","sessionOnly","storage","observers","attached","listen","window","top","detached","unlisten","isNew","saveValue","__setStorageValue","data","e","Promise","reject","resolve","reset","zeroValue","destroy","removeItem","getStoredValue","path","__parseValueFromStorage","setStoredValue","node","__computeStorage","sessionStorage","localStorage","__storageSourceChanged","_initializeStoredValue","__onStorage","event","storageArea","syncToMemory","set","__onAppLocalStorageChanged","detail","JSON","parse","getItem","console","error","setItem","stringify","d","__webpack_exports__","AppStorageBehavior","SPLICES_RX","LENGTH_RX","NUMBER_RX","sequentialTransactions","log","created","__initialized","__syncingToMemory","__initializingStoredValue","__transactionQueueAdvances","ready","transactionsComplete","args","initializeStoredValue","_getStoredValue","then","_log","_setStoredValue","bind","storagePath","memoryPathToStoragePath","storagePathToMemoryPath","operation","_group","call","_groupEnd","valueIsEmpty","isArray","length","prototype","isPrototypeOf","_enqueueTransaction","transaction","result","catch","_error","_len","arguments","_key","apply","_len2","_key2","_len3","_key3","group","_len4","_key4","groupEnd","initializingStoredValue","__dataChanged","change","__pathCanBeIgnored","__normalizeMemoryPath","indexSplices","__pathIsSplices","__parentPath","parts","split","parentPath","currentPath","normalizedPath","i","push","test","join","slice","__pathRefersToArray","__pathTailToIndex","tail","pop","parseInt","replace","315","module","html_tag","polymer_element","events_mixin","defineProperties","target","props","descriptor","enumerable","configurable","writable","defineProperty","Constructor","protoProps","staticProps","freeze","raw","ha_combo_box_HaComboBox","HaComboBox","_items","items","item","itemLabelPath","allowCustomValue","itemValuePath","ha_service_picker_HaServicePicker","localize_mixin","ha_service_picker_createClass","HaServicePicker","oldHass","services","forEach","domain","_services","ha_service_picker_templateObject","ERROR_SENTINEL","HaPanelDevService","_polymer_polymer_polymer_element_js__WEBPACK_IMPORTED_MODULE_6__","serviceData","service","serviceDomains","fields","field","assign","description","domainService","err","parsedJSON","attributes","some","attr","entity_id","alert","callService","_domain","_service","_polymer_polymer_lib_utils_html_tag_js__WEBPACK_IMPORTED_MODULE_5__","narrow","showMenu","validJSON","_attributes","_description"],"mappings":"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","file":"ab2fc5c641be9b9532e3.chunk.js","sourcesContent":["import '@polymer/paper-icon-button/paper-icon-button.js';\nimport '@polymer/paper-input/paper-input.js';\nimport '@polymer/paper-item/paper-icon-item.js';\nimport '@polymer/paper-item/paper-item-body.js';\nimport { html } from '@polymer/polymer/lib/utils/html-tag.js';\nimport { PolymerElement } from '@polymer/polymer/polymer-element.js';\nimport '@vaadin/vaadin-combo-box/vaadin-combo-box-light.js';\n\n\nimport './state-badge.js';\n\nimport computeStateName from '../../common/entity/compute_state_name.js';\nimport LocalizeMixin from '../../mixins/localize-mixin.js';\nimport EventsMixin from '../../mixins/events-mixin.js';\n\n/*\n * @appliesMixin LocalizeMixin\n */\nclass HaEntityPicker extends EventsMixin(LocalizeMixin(PolymerElement)) {\n  static get template() {\n    return html`\n    <style>\n      paper-input > paper-icon-button {\n        width: 24px;\n        height: 24px;\n        padding: 2px;\n        color: var(--secondary-text-color);\n      }\n      [hidden] {\n        display: none;\n      }\n    </style>\n    <vaadin-combo-box-light\n      items=\"[[_states]]\"\n      item-value-path=\"entity_id\"\n      item-label-path=\"entity_id\"\n      value=\"{{value}}\"\n      opened=\"{{opened}}\"\n      allow-custom-value=\"[[allowCustomEntity]]\"\n      on-change='_fireChanged'\n    >\n      <paper-input autofocus=\"[[autofocus]]\" label=\"[[_computeLabel(label, localize)]]\" class=\"input\" value=\"[[value]]\" disabled=\"[[disabled]]\">\n        <paper-icon-button slot=\"suffix\" class=\"clear-button\" icon=\"hass:close\" no-ripple=\"\" hidden$=\"[[!value]]\">Clear</paper-icon-button>\n        <paper-icon-button slot=\"suffix\" class=\"toggle-button\" icon=\"[[_computeToggleIcon(opened)]]\" hidden=\"[[!_states.length]]\">Toggle</paper-icon-button>\n      </paper-input>\n      <template>\n        <style>\n          paper-icon-item {\n            margin: -10px;\n          }\n        </style>\n        <paper-icon-item>\n          <state-badge state-obj=\"[[item]]\" slot=\"item-icon\"></state-badge>\n          <paper-item-body two-line=\"\">\n            <div>[[_computeStateName(item)]]</div>\n            <div secondary=\"\">[[item.entity_id]]</div>\n          </paper-item-body>\n        </paper-icon-item>\n      </template>\n    </vaadin-combo-box-light>\n`;\n  }\n\n  static get properties() {\n    return {\n      allowCustomEntity: {\n        type: Boolean,\n        value: false,\n      },\n      hass: {\n        type: Object,\n        observer: '_hassChanged',\n      },\n      _hass: Object,\n      _states: {\n        type: Array,\n        computed: '_computeStates(_hass, domainFilter, entityFilter)',\n      },\n      autofocus: Boolean,\n      label: {\n        type: String,\n      },\n      value: {\n        type: String,\n        notify: true,\n      },\n      opened: {\n        type: Boolean,\n        value: false,\n        observer: '_openedChanged',\n      },\n      domainFilter: {\n        type: String,\n        value: null,\n      },\n      entityFilter: {\n        type: Function,\n        value: null,\n      },\n      disabled: Boolean,\n    };\n  }\n\n  _computeLabel(label, localize) {\n    return label === undefined\n      ? localize('ui.components.entity.entity-picker.entity')\n      : label;\n  }\n\n  _computeStates(hass, domainFilter, entityFilter) {\n    if (!hass) return [];\n\n    let entityIds = Object.keys(hass.states);\n\n    if (domainFilter) {\n      entityIds = entityIds.filter(eid => eid.substr(0, eid.indexOf('.')) === domainFilter);\n    }\n\n    let entities = entityIds.sort().map(key => hass.states[key]);\n\n    if (entityFilter) {\n      entities = entities.filter(entityFilter);\n    }\n\n    return entities;\n  }\n\n  _computeStateName(state) {\n    return computeStateName(state);\n  }\n\n  _openedChanged(newVal) {\n    if (!newVal) {\n      this._hass = this.hass;\n    }\n  }\n\n  _hassChanged(newVal) {\n    if (!this.opened) {\n      this._hass = newVal;\n    }\n  }\n\n  _computeToggleIcon(opened) {\n    return opened ? 'hass:menu-up' : 'hass:menu-down';\n  }\n\n  _fireChanged(ev) {\n    ev.stopPropagation();\n    this.fire('change');\n  }\n}\n\ncustomElements.define('ha-entity-picker', HaEntityPicker);\n","/* Forked because it contained an import.meta which webpack doesn't support. */\n/* eslint-disable */\n/**\n@license\nCopyright (c) 2016 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\nimport { AppStorageBehavior } from '@polymer/app-storage/app-storage-behavior.js';\nimport { Polymer } from '@polymer/polymer/lib/legacy/polymer-fn.js';\nimport '@polymer/polymer/polymer-legacy.js';\n\n/**\n * app-localstorage-document synchronizes storage between an in-memory\n * value and a location in the browser's localStorage system.\n *\n * localStorage is a simple and widely supported storage API that provides both\n * permanent and session-based storage options. Using app-localstorage-document\n * you can easily integrate localStorage into your app via normal Polymer\n * databinding.\n *\n * app-localstorage-document is the reference implementation of an element\n * that uses `AppStorageBehavior`. Reading its code is a good way to get\n * started writing your own storage element.\n *\n * Example use:\n *\n *     <paper-input value=\"{{search}}\"></paper-input>\n *     <app-localstorage-document key=\"search\" data=\"{{search}}\">\n *     </app-localstorage-document>\n *\n * app-localstorage-document automatically synchronizes changes to the\n * same key across multiple tabs.\n *\n * Only supports storing JSON-serializable values.\n */\nPolymer({\n  is: 'app-localstorage-document',\n  behaviors: [AppStorageBehavior],\n\n  properties: {\n    /**\n     * Defines the logical location to store the data.\n     *\n     * @type{String}\n     */\n    key: {type: String, notify: true},\n\n    /**\n     * If true, the data will automatically be cleared from storage when\n     * the page session ends (i.e. when the user has navigated away from\n     * the page).\n     */\n    sessionOnly: {type: Boolean, value: false},\n\n    /**\n     * Either `window.localStorage` or `window.sessionStorage`, depending on\n     * `this.sessionOnly`.\n     */\n    storage: {type: Object, computed: '__computeStorage(sessionOnly)'}\n  },\n\n  observers: ['__storageSourceChanged(storage, key)'],\n\n  attached: function() {\n    this.listen(window, 'storage', '__onStorage');\n    this.listen(\n        window.top, 'app-local-storage-changed', '__onAppLocalStorageChanged');\n  },\n\n  detached: function() {\n    this.unlisten(window, 'storage', '__onStorage');\n    this.unlisten(\n        window.top, 'app-local-storage-changed', '__onAppLocalStorageChanged');\n  },\n\n  get isNew() {\n    return !this.key;\n  },\n\n  /**\n   * Stores a value at the given key, and if successful, updates this.key.\n   *\n   * @param {*} key The new key to use.\n   * @return {Promise}\n   */\n  saveValue: function(key) {\n    try {\n      this.__setStorageValue(/*{@type if (key ty){String}}*/ key, this.data);\n    } catch (e) {\n      return Promise.reject(e);\n    }\n\n    this.key = /** @type {String} */ (key);\n\n    return Promise.resolve();\n  },\n\n  reset: function() {\n    this.key = null;\n    this.data = this.zeroValue;\n  },\n\n  destroy: function() {\n    try {\n      this.storage.removeItem(this.key);\n      this.reset();\n    } catch (e) {\n      return Promise.reject(e);\n    }\n\n    return Promise.resolve();\n  },\n\n  getStoredValue: function(path) {\n    var value;\n\n    if (this.key != null) {\n      try {\n        value = this.__parseValueFromStorage();\n\n        if (value != null) {\n          value = this.get(path, {data: value});\n        } else {\n          value = undefined;\n        }\n      } catch (e) {\n        return Promise.reject(e);\n      }\n    }\n\n    return Promise.resolve(value);\n  },\n\n  setStoredValue: function(path, value) {\n    if (this.key != null) {\n      try {\n        this.__setStorageValue(this.key, this.data);\n      } catch (e) {\n        return Promise.reject(e);\n      }\n\n      this.fire('app-local-storage-changed', this, {node: window.top});\n    }\n\n    return Promise.resolve(value);\n  },\n\n  __computeStorage: function(sessionOnly) {\n    return sessionOnly ? window.sessionStorage : window.localStorage;\n  },\n\n  __storageSourceChanged: function(storage, key) {\n    this._initializeStoredValue();\n  },\n\n  __onStorage: function(event) {\n    if (event.key !== this.key || event.storageArea !== this.storage) {\n      return;\n    }\n\n    this.syncToMemory(function() {\n      this.set('data', this.__parseValueFromStorage());\n    });\n  },\n\n  __onAppLocalStorageChanged: function(event) {\n    if (event.detail === this || event.detail.key !== this.key ||\n        event.detail.storage !== this.storage) {\n      return;\n    }\n    this.syncToMemory(function() {\n      this.set('data', event.detail.data);\n    });\n  },\n\n  __parseValueFromStorage: function() {\n    try {\n      return JSON.parse(this.storage.getItem(this.key));\n    } catch (e) {\n      console.error('Failed to parse value from storage for', this.key);\n    }\n  },\n\n  __setStorageValue: function(key, value) {\n    if (typeof value === 'undefined')\n      value = null;\n    this.storage.setItem(key, JSON.stringify(value));\n  }\n});","/**\n@license\nCopyright (c) 2016 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at\nhttp://polymer.github.io/LICENSE.txt The complete set of authors may be found at\nhttp://polymer.github.io/AUTHORS.txt The complete set of contributors may be\nfound at http://polymer.github.io/CONTRIBUTORS.txt Code distributed by Google as\npart of the polymer project is also subject to an additional IP rights grant\nfound at http://polymer.github.io/PATENTS.txt\n*/\nimport '@polymer/polymer/polymer-legacy.js';\n\nvar SPLICES_RX = /\\.splices$/;\nvar LENGTH_RX = /\\.length$/;\nvar NUMBER_RX = /\\.?#?([0-9]+)$/;\n\n/**\n * AppStorageBehavior is an abstract behavior that makes it easy to\n * synchronize in-memory data and a persistent storage system, such as\n * the browser's IndexedDB, or a remote database like Firebase.\n *\n * For examples of how to use this behavior to write your own app storage\n * elements see `<app-localstorage-document>` here, or check out\n * [polymerfire](https://github.com/Firebase/polymerfire) and\n * [app-pouchdb](https://github.com/PolymerElements/app-pouchdb).\n *\n * @polymerBehavior\n */\nexport const AppStorageBehavior = {\n  properties: {\n    /**\n     * The data to synchronize.\n     */\n    data: {\n      type: Object,\n      notify: true,\n      value: function() {\n        return this.zeroValue;\n      }\n    },\n\n    /**\n     * If this is true transactions will happen one after the other,\n     * never in parallel.\n     *\n     * Specifically, no transaction will begin until every previously\n     * enqueued transaction by this element has completed.\n     *\n     * If it is false, new transactions will be executed as they are\n     * received.\n     */\n    sequentialTransactions: {type: Boolean, value: false},\n\n    /**\n     * When true, will perform detailed logging.\n     */\n    log: {type: Boolean, value: false}\n  },\n\n  observers: ['__dataChanged(data.*)'],\n\n  created: function() {\n    this.__initialized = false;\n    this.__syncingToMemory = false;\n    this.__initializingStoredValue = null;\n    this.__transactionQueueAdvances = Promise.resolve();\n  },\n\n  ready: function() {\n    this._initializeStoredValue();\n  },\n\n  /**\n   * Override this getter to return true if the value has never been\n   * persisted to storage.\n   *\n   * @return {boolean}\n   */\n  get isNew() {\n    return true;\n  },\n\n  /**\n   * A promise that will resolve once all queued transactions\n   * have completed.\n   *\n   * This field is updated as new transactions are enqueued, so it will\n   * only wait for transactions which were enqueued when the field\n   * was accessed.\n   *\n   * This promise never rejects.\n   *\n   * @return {Promise}\n   */\n  get transactionsComplete() {\n    return this.__transactionQueueAdvances;\n  },\n\n  /**\n   * Override this getter to define the default value to use when\n   * there's no data stored.\n   *\n   * @return {*}\n   */\n  get zeroValue() {\n    return undefined;\n  },\n\n  /**\n   * Override this method.\n   *\n   * If the data value represented by this storage instance is new, this\n   * method generates an attempt to write the value to storage.\n   *\n   *\n   * @param {*} args\n   * @return {Promise} a Promise that settles only once the write has.\n   */\n  saveValue: function(args) {\n    return Promise.resolve();\n  },\n\n  /**\n   * Optional. Override this method to clear out the mapping of this\n   * storage object and a logical location within storage.\n   *\n   * If this method is supported, after it's called, isNew() should be\n   * true.\n   */\n  reset: function() {},\n\n  /**\n   * Remove the data from storage.\n   *\n   * @return {Promise} A promise that settles once the destruction is\n   *   complete.\n   */\n  destroy: function() {\n    this.data = this.zeroValue;\n    return this.saveValue();\n  },\n\n  /**\n   * Perform the initial sync between storage and memory. This method\n   * is called automatically while the element is being initialized.\n   * Implementations may override it.\n   *\n   * If an implementation intends to call this method, it should instead\n   * call _initializeStoredValue, which provides reentrancy protection.\n   *\n   * @return {Promise} A promise that settles once this process is\n   *     complete.\n   */\n  initializeStoredValue: function() {\n    if (this.isNew) {\n      return Promise.resolve();\n    }\n\n    // If this is not a \"new\" model, then we should attempt\n    // to read an initial value from storage:\n    return this._getStoredValue('data').then(function(data) {\n      this._log('Got stored value!', data, this.data);\n      if (data == null) {\n        return this._setStoredValue('data', this.data || this.zeroValue);\n      } else {\n        this.syncToMemory(function() {\n          this.set('data', data);\n        });\n      }\n    }.bind(this));\n  },\n\n  /**\n   * Override this method to implement reading a value from storage.\n   *\n   *\n   * @param {string} storagePath The path (through storage) of the value to\n   *   create, relative to the root of storage associated with this instance.\n   * @return {Promise} A promise that resolves with the canonical value stored\n   *   at the provided path when the transaction has completed. _If there is no\n   *   such value at the provided path through storage, then the promise will\n   *   resolve to `undefined`._ The promise will be rejected if the transaction\n   *   fails for any reason.\n   */\n  getStoredValue: function(storagePath) {\n    return Promise.resolve();\n  },\n\n  /**\n   * Override this method to implement creating and updating\n   * stored values.\n   *\n   *\n   * @param {string} storagePath The path of the value to update, relative\n   *   to the root storage path configured for this instance.\n   * @param {*} value The updated in-memory value to apply to the stored value\n   *   at the provided path.\n   * @return {Promise} A promise that resolves with the canonical value stored\n   *   at the provided path when the transaction has completed. The promise\n   *   will be rejected if the transaction fails for any reason.\n   */\n  setStoredValue: function(storagePath, value) {\n    return Promise.resolve(value);\n  },\n\n  /**\n   * Maps a Polymer databinding path to the corresponding path in the\n   * storage system. Override to define a custom mapping.\n   *\n   * The inverse of storagePathToMemoryPath.\n   *\n   * @param {string} path An in-memory path through a storage object.\n   * @return {string} The provided path mapped to the equivalent location in\n   *   storage. This mapped version of the path is suitable for use with the\n   *   CRUD operations on both memory and storage.\n   */\n  memoryPathToStoragePath: function(path) {\n    return path;\n  },\n\n  /**\n   * Maps a storage path to the corresponding Polymer databinding path.\n   * Override to define a custom mapping.\n   *\n   * The inverse of memoryPathToStoragePath.\n   *\n   * @param {string} path The storage path through a storage object.\n   * @return {string} The provided path through storage mapped to the\n   *   equivalent Polymer path through the in-memory representation of storage.\n   */\n  storagePathToMemoryPath: function(path) {\n    return path;\n  },\n\n  /**\n   * Enables performing transformations on the in-memory representation of\n   * storage without activating observers that will cause those\n   * transformations to be re-applied to the storage backend. This is useful\n   * for preventing redundant (or cyclical) application of transformations.\n   *\n   * @param {Function} operation A function that will perform the desired\n   *   transformation. It will be called synchronously, when it is safe to\n   *   apply the transformation.\n   */\n  syncToMemory: function(operation) {\n    if (this.__syncingToMemory) {\n      return;\n    }\n\n    this._group('Sync to memory.');\n\n    this.__syncingToMemory = true;\n    operation.call(this);\n    this.__syncingToMemory = false;\n\n    this._groupEnd('Sync to memory.');\n  },\n\n  /**\n   * A convenience method. Returns true iff value is null, undefined,\n   * an empty array, or an object with no keys.\n   */\n  valueIsEmpty: function(value) {\n    if (Array.isArray(value)) {\n      return value.length === 0;\n    } else if (Object.prototype.isPrototypeOf(value)) {\n      return Object.keys(value).length === 0;\n    } else {\n      return value == null;\n    }\n  },\n\n  /**\n   * Like `getStoredValue` but called with a Polymer path rather than\n   * a storage path.\n   *\n   * @param {string} path The Polymer path to get.\n   * @return {Promise} A Promise of the value stored at that path.\n   */\n  _getStoredValue: function(path) {\n    return this.getStoredValue(this.memoryPathToStoragePath(path));\n  },\n\n  /**\n   * Like `setStoredValue` but called with a Polymer path rather than\n   * a storage path.\n   *\n   * @param {string} path The Polymer path to update.\n   * @param {*} value The updated in-memory value to apply to the stored value\n   *   at the provided path.\n   * @return {Promise} A promise that resolves with the canonical value stored\n   *   at the provided path when the transaction has completed. The promise\n   *   will be rejected if the transaction fails for any reason.\n   */\n  _setStoredValue: function(path, value) {\n    return this.setStoredValue(this.memoryPathToStoragePath(path), value);\n  },\n\n  /**\n   * Enqueues the given function in the transaction queue.\n   *\n   * The transaction queue allows for optional parallelism/sequentiality\n   * via the `sequentialTransactions` boolean property, as well as giving\n   * the user a convenient way to wait for all pending transactions to\n   * finish.\n   *\n   * The given function may be called immediately or after an arbitrary\n   * delay. Its `this` context will be bound to the element.\n   *\n   * If the transaction performs any asynchronous operations it must\n   * return a promise.\n   *\n   * @param {Function} transaction A function implementing the transaction.\n   * @return {Promise} A promise that resolves once the transaction has\n   *   finished. This promise will never reject.\n   */\n  _enqueueTransaction: function(transaction) {\n    if (this.sequentialTransactions) {\n      transaction = transaction.bind(this);\n    } else {\n      var result = transaction.call(this);\n      transaction = function() {\n        return result;\n      };\n    }\n\n    return this.__transactionQueueAdvances =\n               this.__transactionQueueAdvances.then(transaction)\n                   .catch(function(error) {\n                     this._error('Error performing queued transaction.', error);\n                   }.bind(this));\n  },\n\n  /**\n   * A wrapper around `console.log`.\n   */\n  _log: function(...args) {\n    if (this.log) {\n      console.log.apply(console, args);\n    }\n  },\n\n  /**\n   * A wrapper around `console.error`.\n   */\n  _error: function(...args) {\n    if (this.log) {\n      console.error.apply(console, args);\n    }\n  },\n\n  /**\n   * A wrapper around `console.group`.\n   */\n  _group: function(...args) {\n    if (this.log) {\n      console.group.apply(console, args);\n    }\n  },\n\n  /**\n   * A wrapper around `console.groupEnd`.\n   */\n  _groupEnd: function(...args) {\n    if (this.log) {\n      console.groupEnd.apply(console, args);\n    }\n  },\n\n  /**\n   * A reentrancy-save wrapper around `this.initializeStoredValue`.\n   * Prefer calling this method over that one.\n   *\n   * @return {Promise} The result of calling `initializeStoredValue`,\n   *   or `undefined` if called while initializing.\n   */\n  _initializeStoredValue: function() {\n    if (this.__initializingStoredValue) {\n      return;\n    }\n\n    this._group('Initializing stored value.');\n\n    var initializingStoredValue = this.__initializingStoredValue =\n        this.initializeStoredValue()\n            .then(function() {\n              this.__initialized = true;\n              this.__initializingStoredValue = null;\n              this._groupEnd('Initializing stored value.');\n            }.bind(this))\n            .catch(function(e) {\n              this.__initializingStoredValue = null;\n              this._groupEnd('Initializing stored value.');\n            }.bind(this));\n\n    return this._enqueueTransaction(function() {\n      return initializingStoredValue;\n    });\n  },\n\n  __dataChanged: function(change) {\n    if (this.isNew || this.__syncingToMemory || !this.__initialized ||\n        this.__pathCanBeIgnored(change.path)) {\n      return;\n    }\n\n    var path = this.__normalizeMemoryPath(change.path);\n    var value = change.value;\n    var indexSplices = value && value.indexSplices;\n\n    this._enqueueTransaction(function() {\n      this._log('Setting', path + ':', indexSplices || value);\n\n      if (indexSplices && this.__pathIsSplices(path)) {\n        path = this.__parentPath(path);\n        value = this.get(path);\n      }\n\n      return this._setStoredValue(path, value);\n    });\n  },\n\n  __normalizeMemoryPath: function(path) {\n    var parts = path.split('.');\n    var parentPath = [];\n    var currentPath = [];\n    var normalizedPath = [];\n    var index;\n\n    for (var i = 0; i < parts.length; ++i) {\n      currentPath.push(parts[i]);\n      if (/^#/.test(parts[i])) {\n        normalizedPath.push(\n            this.get(parentPath).indexOf(this.get(currentPath)));\n      } else {\n        normalizedPath.push(parts[i]);\n      }\n      parentPath.push(parts[i]);\n    }\n\n    return normalizedPath.join('.');\n  },\n\n  __parentPath: function(path) {\n    var parentPath = path.split('.');\n    return parentPath.slice(0, parentPath.length - 1).join('.');\n  },\n\n  __pathCanBeIgnored: function(path) {\n    return LENGTH_RX.test(path) &&\n        Array.isArray(this.get(this.__parentPath(path)));\n  },\n\n  __pathIsSplices: function(path) {\n    return SPLICES_RX.test(path) &&\n        Array.isArray(this.get(this.__parentPath(path)));\n  },\n\n  __pathRefersToArray: function(path) {\n    return (SPLICES_RX.test(path) || LENGTH_RX.test(path)) &&\n        Array.isArray(this.get(this.__parentPath(path)));\n  },\n\n  __pathTailToIndex: function(path) {\n    var tail = path.split('.').pop();\n    return window.parseInt(tail.replace(NUMBER_RX, '$1'), 10);\n  }\n};\n","import '@polymer/paper-icon-button/paper-icon-button.js';\nimport '@polymer/paper-input/paper-input.js';\nimport '@polymer/paper-item/paper-item.js';\nimport { html } from '@polymer/polymer/lib/utils/html-tag.js';\nimport { PolymerElement } from '@polymer/polymer/polymer-element.js';\nimport '@vaadin/vaadin-combo-box/vaadin-combo-box-light.js';\n\nimport EventsMixin from '../mixins/events-mixin.js';\n\nclass HaComboBox extends EventsMixin(PolymerElement) {\n  static get template() {\n    return html`\n    <style>\n      paper-input > paper-icon-button {\n        width: 24px;\n        height: 24px;\n        padding: 2px;\n        color: var(--secondary-text-color);\n      }\n      [hidden] {\n        display: none;\n      }\n    </style>\n    <vaadin-combo-box-light\n      items=\"[[_items]]\"\n      item-value-path=\"[[itemValuePath]]\"\n      item-label-path=\"[[itemLabelPath]]\"\n      value=\"{{value}}\"\n      opened=\"{{opened}}\"\n      allow-custom-value=\"[[allowCustomValue]]\"\n      on-change='_fireChanged'\n    >\n      <paper-input autofocus=\"[[autofocus]]\" label=\"[[label]]\" class=\"input\" value=\"[[value]]\">\n        <paper-icon-button slot=\"suffix\" class=\"clear-button\" icon=\"hass:close\" hidden$=\"[[!value]]\">Clear</paper-icon-button>\n        <paper-icon-button slot=\"suffix\" class=\"toggle-button\" icon=\"[[_computeToggleIcon(opened)]]\" hidden$=\"[[!items.length]]\">Toggle</paper-icon-button>\n      </paper-input>\n      <template>\n        <style>\n            paper-item {\n              margin: -5px -10px;\n            }\n        </style>\n        <paper-item>[[_computeItemLabel(item, itemLabelPath)]]</paper-item>\n      </template>\n    </vaadin-combo-box-light>\n`;\n  }\n\n  static get properties() {\n    return {\n      allowCustomValue: Boolean,\n      items: {\n        type: Object,\n        observer: '_itemsChanged',\n      },\n      _items: Object,\n      itemLabelPath: String,\n      itemValuePath: String,\n      autofocus: Boolean,\n      label: String,\n      opened: {\n        type: Boolean,\n        value: false,\n        observer: '_openedChanged',\n      },\n      value: {\n        type: String,\n        notify: true,\n      },\n    };\n  }\n\n  _openedChanged(newVal) {\n    if (!newVal) {\n      this._items = this.items;\n    }\n  }\n\n  _itemsChanged(newVal) {\n    if (!this.opened) {\n      this._items = newVal;\n    }\n  }\n\n  _computeToggleIcon(opened) {\n    return opened ? 'hass:menu-up' : 'hass:menu-down';\n  }\n\n  _computeItemLabel(item, itemLabelPath) {\n    return itemLabelPath ? item[itemLabelPath] : item;\n  }\n\n  _fireChanged(ev) {\n    ev.stopPropagation();\n    this.fire('change');\n  }\n}\n\ncustomElements.define('ha-combo-box', HaComboBox);\n","import { html } from '@polymer/polymer/lib/utils/html-tag.js';\nimport { PolymerElement } from '@polymer/polymer/polymer-element.js';\n\n\nimport './ha-combo-box.js';\n\nimport LocalizeMixin from '../mixins/localize-mixin.js';\n\n/*\n * @appliesMixin LocalizeMixin\n */\nclass HaServicePicker extends LocalizeMixin(PolymerElement) {\n  static get template() {\n    return html`\n    <ha-combo-box label=\"[[localize('ui.components.service-picker.service')]]\" items=\"[[_services]]\" value=\"{{value}}\" allow-custom-value=\"\"></ha-combo-box>\n`;\n  }\n\n  static get properties() {\n    return {\n      hass: {\n        type: Object,\n        observer: '_hassChanged',\n      },\n      _services: Array,\n      value: {\n        type: String,\n        notify: true,\n      },\n    };\n  }\n\n  _hassChanged(hass, oldHass) {\n    if (!hass) {\n      this._services = [];\n      return;\n    } else if (oldHass && hass.services === oldHass.services) {\n      return;\n    }\n    const result = [];\n\n    Object.keys(hass.services).sort().forEach((domain) => {\n      const services = Object.keys(hass.services[domain]).sort();\n\n      for (let i = 0; i < services.length; i++) {\n        result.push(`${domain}.${services[i]}`);\n      }\n    });\n\n    this._services = result;\n  }\n}\n\ncustomElements.define('ha-service-picker', HaServicePicker);\n","import '@polymer/app-layout/app-header-layout/app-header-layout.js';\nimport '@polymer/app-layout/app-header/app-header.js';\nimport '@polymer/app-layout/app-toolbar/app-toolbar.js';\nimport '@polymer/paper-button/paper-button.js';\nimport '@polymer/paper-input/paper-textarea.js';\nimport { html } from '@polymer/polymer/lib/utils/html-tag.js';\nimport { PolymerElement } from '@polymer/polymer/polymer-element.js';\n\nimport '../../components/entity/ha-entity-picker.js';\nimport '../../components/ha-menu-button.js';\nimport '../../components/ha-service-picker.js';\nimport '../../resources/ha-style.js';\nimport '../../util/app-localstorage-document.js';\n\nconst ERROR_SENTINEL = {};\nclass HaPanelDevService extends PolymerElement {\n  static get template() {\n    return html`\n  <style include='ha-style'>\n    :host {\n      -ms-user-select: initial;\n      -webkit-user-select: initial;\n      -moz-user-select: initial;\n    }\n\n    .content {\n      padding: 16px;\n    }\n\n    .ha-form {\n      margin-right: 16px;\n      max-width: 400px;\n    }\n\n    .description {\n      margin-top: 24px;\n      white-space: pre-wrap;\n    }\n\n    .header {\n      @apply --paper-font-title;\n    }\n\n    .attributes th {\n      text-align: left;\n    }\n\n    .attributes tr {\n      vertical-align: top;\n    }\n\n    .attributes tr:nth-child(odd) {\n      background-color: var(--table-row-background-color,#eee)\n    }\n\n    .attributes tr:nth-child(even) {\n      background-color: var(--table-row-alternative-background-color,#eee)\n    }\n\n    .attributes td:nth-child(3) {\n      white-space: pre-wrap;\n      word-break: break-word;\n    }\n\n    pre {\n      margin: 0;\n    }\n\n    h1 {\n      white-space: normal;\n    }\n\n    td {\n      padding: 4px;\n    }\n\n    .error {\n      color: var(--google-red-500);\n    }\n  </style>\n\n  <app-header-layout has-scrolling-region>\n    <app-header slot=\"header\" fixed>\n      <app-toolbar>\n        <ha-menu-button narrow='[[narrow]]' show-menu='[[showMenu]]'></ha-menu-button>\n        <div main-title>Services</div>\n      </app-toolbar>\n    </app-header>\n\n    <app-localstorage-document\n      key='panel-dev-service-state-domain-service'\n      data='{{domainService}}'>\n    </app-localstorage-document>\n    <app-localstorage-document\n      key='[[_computeServicedataKey(domainService)]]'\n      data='{{serviceData}}'>\n    </app-localstorage-document>\n\n    <div class='content'>\n      <p>\n        The service dev tool allows you to call any available service in Home Assistant.\n      </p>\n\n      <div class='ha-form'>\n        <ha-service-picker\n          hass='[[hass]]'\n          value='{{domainService}}'\n        ></ha-service-picker>\n        <template is='dom-if' if='[[_computeHasEntity(_attributes)]]'>\n          <ha-entity-picker\n            hass='[[hass]]'\n            value='[[_computeEntityValue(parsedJSON)]]'\n            on-change='_entityPicked'\n            disabled='[[!validJSON]]'\n            domain-filter='[[_computeEntityDomainFilter(_domain)]]'\n            allow-custom-entity\n          ></ha-entity-picker>\n        </template>\n        <paper-textarea\n          always-float-label\n          label='Service Data (JSON, optional)'\n          value='{{serviceData}}'\n        ></paper-textarea>\n        <paper-button\n          on-click='_callService'\n          raised\n          disabled='[[!validJSON]]'\n        >Call Service</paper-button>\n        <template is='dom-if' if='[[!validJSON]]'>\n            <span class='error'>Invalid JSON</span>\n        </template>\n      </div>\n\n      <template is='dom-if' if='[[!domainService]]'>\n        <h1>Select a service to see the description</h1>\n      </template>\n\n      <template is='dom-if' if='[[domainService]]'>\n        <template is='dom-if' if='[[!_description]]'>\n          <h1>No description is available</h1>\n        </template>\n        <template is='dom-if' if='[[_description]]'>\n          <h3>[[_description]]</h3>\n\n          <table class='attributes'>\n            <tr>\n              <th>Parameter</th>\n              <th>Description</th>\n              <th>Example</th>\n            </tr>\n            <template is='dom-if' if='[[!_attributes.length]]'>\n              <tr><td colspan='3'>This service takes no parameters.</td></tr>\n            </template>\n            <template is='dom-repeat' items='[[_attributes]]' as='attribute'>\n              <tr>\n                <td><pre>[[attribute.key]]</pre></td>\n                <td>[[attribute.description]]</td>\n                <td>[[attribute.example]]</td>\n              </tr>\n            </template>\n          </table>\n        </template>\n      </template>\n    </div>\n\n  </app-header-layout>\n    `;\n  }\n\n  static get properties() {\n    return {\n      hass: {\n        type: Object,\n      },\n\n      narrow: {\n        type: Boolean,\n        value: false,\n      },\n\n      showMenu: {\n        type: Boolean,\n        value: false,\n      },\n\n      domainService: {\n        type: String,\n        observer: '_domainServiceChanged',\n      },\n\n      _domain: {\n        type: String,\n        computed: '_computeDomain(domainService)',\n      },\n\n      _service: {\n        type: String,\n        computed: '_computeService(domainService)',\n      },\n\n      serviceData: {\n        type: String,\n        value: '',\n      },\n\n      parsedJSON: {\n        type: Object,\n        computed: '_computeParsedServiceData(serviceData)'\n      },\n\n      validJSON: {\n        type: Boolean,\n        computed: '_computeValidJSON(parsedJSON)',\n      },\n\n      _attributes: {\n        type: Array,\n        computed: '_computeAttributesArray(hass, _domain, _service)',\n      },\n\n      _description: {\n        type: String,\n        computed: '_computeDescription(hass, _domain, _service)',\n      },\n    };\n  }\n\n  _domainServiceChanged() {\n    this.serviceData = '';\n  }\n\n  _computeAttributesArray(hass, domain, service) {\n    const serviceDomains = hass.services;\n    if (!(domain in serviceDomains)) return [];\n    if (!(service in serviceDomains[domain])) return [];\n\n    const fields = serviceDomains[domain][service].fields;\n    return Object.keys(fields).map(function (field) {\n      return Object.assign({ key: field }, fields[field]);\n    });\n  }\n\n  _computeDescription(hass, domain, service) {\n    const serviceDomains = hass.services;\n    if (!(domain in serviceDomains)) return undefined;\n    if (!(service in serviceDomains[domain])) return undefined;\n    return serviceDomains[domain][service].description;\n  }\n\n  _computeServicedataKey(domainService) {\n    return `panel-dev-service-state-servicedata.${domainService}`;\n  }\n\n  _computeDomain(domainService) {\n    return domainService.split('.', 1)[0];\n  }\n\n  _computeService(domainService) {\n    return domainService.split('.', 2)[1] || null;\n  }\n\n  _computeParsedServiceData(serviceData) {\n    try {\n      return serviceData ? JSON.parse(serviceData) : {};\n    } catch (err) {\n      return ERROR_SENTINEL;\n    }\n  }\n\n  _computeValidJSON(parsedJSON) {\n    return parsedJSON !== ERROR_SENTINEL;\n  }\n\n  _computeHasEntity(attributes) {\n    return attributes.some(attr => attr.key === 'entity_id');\n  }\n\n  _computeEntityValue(parsedJSON) {\n    return parsedJSON === ERROR_SENTINEL ? '' : parsedJSON.entity_id;\n  }\n\n  _computeEntityDomainFilter(domain) {\n    return domain === 'homeassistant' ? null : domain;\n  }\n\n  _callService() {\n    if (this.parsedJSON === ERROR_SENTINEL) {\n      // eslint-disable-next-line\n      alert(`Error parsing JSON: ${this.serviceData}`);\n    }\n\n    this.hass.callService(this._domain, this._service, this.parsedJSON);\n  }\n\n  _entityPicked(ev) {\n    this.serviceData = JSON.stringify(Object.assign({}, this.parsedJSON, {\n      entity_id: ev.target.value\n    }), null, 2);\n  }\n}\n\ncustomElements.define('ha-panel-dev-service', HaPanelDevService);\n"],"sourceRoot":""}